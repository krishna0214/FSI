import numpy as np
from scipy.interpolate import UnivariateSpline
import matplotlib.pyplot as plt

# Your data
x = np.array([0, 0.010827067669172935, 0.02165413533834587, 0.035187969924812046, 0.048721804511278194, 0.060902255639097735, 0.0730827067669173, 0.0825563909774436, 0.0893233082706767, 0.09744360902255639, 0.10421052631578948, 0.11097744360902256, 0.1177443609022556, 0.12586466165413535, 0.13263157894736843, 0.13804511278195492, 0.14616541353383455, 0.15699248120300752, 0.16646616541353382, 0.1786466165413534, 0.1894736842105263, 0.20030075187969926, 0.20977443609022556, 0.22195488721804513, 0.23007518796992482, 0.23954887218045112, 0.24766917293233082, 0.2557894736842105, 0.2666165413533835, 0.2760902255639098, 0.2855639097744361, 0.2923308270676692, 0.30045112781954886, 0.30992481203007516, 0.31939849624060146, 0.3275187969924812, 0.3369924812030075, 0.3464661654135339, 0.35458646616541356, 0.36406015037593986, 0.3735338345864663, 0.38300751879699246, 0.39248120300751876, 0.40601503759398505, 0.4195488721804511, 0.43443609022556384, 0.44661654135338347, 0.4615037593984962, 0.47233082706766927, 0.487218045112782, 0.5007518796992482, 0.5142857142857142, 0.5291729323308271, 0.5413533834586466, 0.5535338345864661, 0.5684210526315789, 0.5792481203007519, 0.5914285714285715, 0.6063157894736843, 0.6171428571428571, 0.6320300751879699, 0.6442105263157895, 0.6590977443609023, 0.6712781954887218, 0.684812030075188, 0.695639097744361, 0.709172932330827, 0.7227067669172933, 0.7362406015037594, 0.7497744360902256, 0.7619548872180452, 0.7754887218045113, 0.7876691729323309, 0.8025563909774437])
y = np.array([0.004, 0.0786026200873362, 0.1179039301310052, 0.1965065502183414, 0.3930131004366828, 0.6681222707423586, 0.9432314410480345, 1.3362445414847173, 1.6899563318777293, 2.082969432314412, 2.5152838427947604, 2.8689956331877724, 3.2620087336244534, 3.6550218340611345, 3.969432314410481, 4.323144104803495, 4.598253275109171, 4.794759825327512, 4.951965065502183, 4.951965065502183, 4.794759825327512, 4.598253275109171, 4.323144104803495, 3.969432314410481, 3.7336244541484724, 3.458515283842795, 3.222707423580786, 2.9475982532751104, 2.5938864628820966, 2.2794759825327517, 1.9650655021834051, 1.650655021834062, 1.4541484716157207, 1.179039301310043, 0.9432314410480345, 0.6681222707423586, 0.3144104803493448, 0.0786026200873362, -0.1572052401746724, -0.3930131004366828, -0.6288209606986896, -0.7467248908296966, -0.9039301310043673, -0.9432314410480327, -0.9432314410480327, -0.8646288209606983, -0.8253275109170328, -0.6288209606986896, -0.5502183406113534, -0.43231441048034824, -0.3144104803493448, -0.23580786026200862, -0.1572052401746724, -0.0786026200873362, 0, 0, 0.0786026200873362, 0.0786026200873362, 0.1179039301310052, 0.1179039301310052, 0.1179039301310052, 0.1179039301310052, 0.0786026200873362, 0.1179039301310052, 0.0786026200873362, 0.0786026200873362, 0.0786026200873362, 0.0786026200873362, 0, -0.0786026200873362, -0.0786026200873362, -0.0786026200873362, -0.0786026200873362, -0.1179039301310052])

# Fit a spline to the data
spline = UnivariateSpline(x, y, s=1)


flow_rate = np.array([2.8284024, 2.9467456, 3.0887574, 3.183432, 3.3491124, 3.4674556, 3.6568047,
    3.7988166, 3.964497, 4.1775148, 4.4615385, 4.6508876, 4.8639053, 5.0295858,5.2189349, 5.4319527, 5.6923077, 5.8816568, 6.0236686, 6.2130178, 6.4260355,
    6.6390533, 6.7573964, 6.9467456, 7.1597633, 7.3491124, 7.5857988, 7.8461538,8.0118343, 8.2011834, 8.4378698, 8.5798817, 8.7455621, 8.9585799, 9.1952663,
    9.3372781, 9.5029586, 9.6449704, 9.8106509, 10.047337, 10.260355, 10.473373,10.662722, 10.852071, 11.04142, 11.183432, 11.39645, 11.56213, 11.704142,
    11.91716, 12.130178, 12.366864, 12.579882, 12.721893, 12.816568, 12.911243,13.005917, 13.100592, 13.171598, 13.195266, 13.171598, 13.076923, 13.005917,
    12.911243, 12.792899, 12.698225, 12.508876, 12.414201, 12.343195, 12.201183,12.08284, 11.964497, 11.775148, 11.609467, 11.443787, 11.278107, 11.04142,
    10.87574, 10.710059, 10.544379, 10.378698, 10.213018, 10, 9.8106509, 9.6686391,9.4556213, 9.2662722, 9.0532544, 8.887574, 8.6508876, 8.3905325, 8.1775148,
    7.9408284, 7.7278107, 7.5147929, 7.3254438, 7.0887574, 6.8757396, 6.6627219,6.4023669, 6.1893491, 5.9763314, 5.7633136, 5.6449704, 5.4556213, 5.3372781,
    5.2189349, 5.147929, 5.147929, 5.147929, 5.1952663, 5.3136095, 5.4319527,5.5739645, 5.6449704, 5.739645, 5.7633136, 5.7633136, 5.739645, 5.6449704,
    5.4556213, 5.3609467, 5.2189349, 5.1242604, 4.9822485, 4.8639053, 4.7692308,4.6508876, 4.6035503, 4.4142012, 4.3668639, 4.3431953, 4.295858, 4.2011834,
    4.0591716, 3.964497, 3.8224852, 3.7514793, 3.6094675, 3.4911243, 3.4201183,3.443787, 3.443787, 3.443787, 3.443787, 3.5147929, 3.5621302, 3.5857988,
    3.5857988, 3.5857988, 3.5857988, 3.5857988, 3.5857988, 3.5384615, 3.443787,3.4201183, 3.4201183, 3.4201183, 3.4201183, 3.4674556, 3.5384615, 3.6094675,
    3.5857988, 3.5857988, 3.5857988, 3.5621302, 3.443787, 3.443787, 3.3727811,3.3727811, 3.3964497, 3.443787, 3.5384615, 3.5857988, 3.5857988, 3.6094675,
    3.5147929, 3.443787, 3.3727811, 3.3727811, 3.3254438, 3.3491124
])
time1 = np.array([
    0.000906618, 0.007252947, 0.012692656, 0.01631913, 0.019945603,0.023572076, 0.027198549, 0.030825023, 0.032638259, 0.034451496,
    0.036264733, 0.038984587, 0.040797824, 0.041704442, 0.044424297,0.047144152, 0.048050771, 0.049864007, 0.051677244, 0.052583862,
    0.053490481, 0.056210335, 0.057116954, 0.057116954, 0.05893019,0.061650045, 0.063463282, 0.0643699, 0.066183137, 0.067996374,
    0.068902992, 0.06980961, 0.073436083, 0.073436083, 0.07524932,0.07524932, 0.077969175, 0.08068903, 0.08068903, 0.082502267,
    0.084315503, 0.087035358, 0.088848595, 0.090661831, 0.090661831,0.093381686, 0.094288305, 0.096101541, 0.096101541, 0.099728015,
    0.10335449, 0.10698096, 0.11060743, 0.11604714, 0.12058024,0.12239347, 0.1287398, 0.13417951, 0.14052584, 0.1486854,
    0.15412511, 0.15956482, 0.16863101, 0.17588395, 0.18404352,0.19129646, 0.19673617, 0.20489574, 0.20852221, 0.2130553,
    0.21668178, 0.22121487, 0.22393472, 0.22937443, 0.23390752,0.23934723, 0.24388033, 0.24841342, 0.25113327, 0.25475975,
    0.25929284, 0.26201269, 0.26291931, 0.26835902, 0.27289211,0.27561197, 0.28014506, 0.28467815, 0.28739801, 0.29102448,
    0.29646419, 0.30281052, 0.30734361, 0.31368994, 0.31731641,0.32275612, 0.32728921, 0.33272892, 0.33998187, 0.34542158,
    0.35358114, 0.35992747, 0.3662738, 0.37171351, 0.37805984,0.38349955, 0.39165911, 0.40072529, 0.40797824, 0.41432457,
    0.42157752, 0.42973708, 0.43789665, 0.44786945, 0.45602901,0.46328196, 0.46962829, 0.47416138, 0.48232094, 0.48957389,
    0.4950136, 0.50135993, 0.51042611, 0.51858568, 0.52311877,0.52674524, 0.53309157, 0.54125113, 0.54669084, 0.55394379,
    0.56482321, 0.57388939, 0.5793291, 0.58658205, 0.59655485,0.60834089, 0.61740707, 0.62919311, 0.63825929, 0.64641886,
    0.65548504, 0.66364461, 0.66908432, 0.67452403, 0.68359021,0.69356301, 0.70081596, 0.7080689, 0.71532185, 0.72438803,
    0.72982774, 0.73708069, 0.74342702, 0.75067996, 0.76155938,0.76881233, 0.78059837, 0.7869447, 0.79782412, 0.8068903,
    0.81323663, 0.82139619, 0.82955576, 0.83952856, 0.84768812,0.85766092, 0.86763373, 0.87760653, 0.88667271, 0.89483228,
    0.90299184, 0.90933817, 0.91931097, 0.92747053, 0.93925657,0.95104261, 0.95920218, 0.9700816, 0.98186763, 0.99184044,0.99909338, 1.0054397])

spline1 = UnivariateSpline(time1, flow_rate, s=1)

def velocity(Area,time):
    y_value = spline1(time)
    u_in=(((y_value*10**-6))/(Area))
    return u_in






time2 = np.array([
    0, 0.007498, 0.01312, 0.02062, 0.02999, 0.03655, 0.04217, 0.0478, 0.05248, 0.05623, 0.05904, 0.06467,
    0.06935, 0.07123, 0.07685, 0.0806, 0.08341, 0.08529, 0.08903, 0.09278, 0.09466, 0.09466, 0.09841, 0.1012,
    0.1031, 0.1059, 0.1059, 0.1097, 0.1125, 0.1153, 0.1172, 0.1209, 0.1246, 0.1275, 0.1321, 0.1359, 0.1396,
    0.1434, 0.1471, 0.15, 0.1546, 0.1603, 0.1621, 0.1678, 0.1734, 0.1771, 0.1828, 0.1893, 0.1959, 0.2024,
    0.2071, 0.2127, 0.2184, 0.2249, 0.2334, 0.2399, 0.2455, 0.2568, 0.2662, 0.2727, 0.2784, 0.2887, 0.3008,
    0.3074, 0.3196, 0.3346, 0.3402, 0.3468, 0.3571, 0.3664, 0.3711, 0.3758, 0.3833, 0.3899, 0.3983, 0.4086,
    0.4171, 0.4283, 0.4405, 0.4508, 0.4602, 0.4742, 0.477, 0.4864, 0.4967, 0.5014, 0.508, 0.5183, 0.5239,
    0.5314, 0.5408, 0.5455, 0.5539, 0.5633, 0.5717, 0.5783, 0.5867, 0.5979, 0.6064, 0.6148, 0.6242, 0.6373,
    0.6429, 0.6523, 0.6598, 0.6673, 0.6757, 0.6832, 0.6926, 0.701, 0.7085, 0.7226, 0.7291, 0.7357, 0.746,
    0.7573, 0.7648, 0.7732, 0.7844, 0.7938, 0.8032, 0.8116, 0.8172, 0.8257, 0.8351, 0.8454, 0.8529, 0.8632,
    0.8744, 0.881, 0.8903, 0.9016, 0.91, 0.9175, 0.925, 0.9353, 0.9447, 0.956, 0.9663, 0.9756, 0.9822,
    0.9934, 1.001
])


pressure_array = np.array([
    10.75, 10.69, 10.65, 10.6, 10.58, 10.61, 10.66, 10.71, 10.75, 10.8,
    10.85, 10.91, 10.98, 11.08, 11.16, 11.28, 11.34, 11.4, 11.49, 11.55,
    11.61, 11.69, 11.74, 11.81, 11.9, 11.97, 12.03, 12.09, 12.17, 12.25,
    12.34, 12.42, 12.51, 12.57, 12.67, 12.75, 12.82, 12.94, 13.03, 13.1,
    13.19, 13.27, 13.37, 13.48, 13.56, 13.66, 13.74, 13.82, 13.92, 14.04,
    14.13, 14.2, 14.28, 14.35, 14.44, 14.52, 14.57, 14.62, 14.68, 14.72,
    14.73, 14.74, 14.74, 14.74, 14.71, 14.71, 14.66, 14.61, 14.56, 14.53,
    14.47, 14.41, 14.37, 14.3, 14.28, 14.21, 14.18, 14.11, 14.09, 14.05,
    14.04, 14.03, 14.02, 13.99, 13.94, 13.92, 13.87, 13.8, 13.77, 13.71,
    13.7, 13.63, 13.59, 13.52, 13.47, 13.44, 13.36, 13.29, 13.25, 13.18,
    13.1, 13.03, 12.98, 12.89, 12.8, 12.77, 12.7, 12.65, 12.59, 12.56, 12.49,
    12.43, 12.37, 12.34, 12.31, 12.23, 12.17, 12.12, 12.08, 12, 11.95, 11.92,
    11.88, 11.82, 11.8, 11.78, 11.72, 11.68, 11.65, 11.59, 11.55, 11.52,
    11.48, 11.44, 11.41, 11.35, 11.3, 11.26, 11.24, 11.23, 11.19, 11.15,
    11.12
])


spline2 = UnivariateSpline(time2, pressure_array, s=0.5)
def Pressure(time):
    pressure = spline2(time)
    return pressure


    

'''
x_spline = np.linspace(time2.min(), time2.max(), len(time2))  # Generate points for smooth curve
y_spline = spline2(x_spline)  # Compute corresponding y values using the spline
plt.plot(time2, pressure_array, 'o', label='Data Points')  # Plot original data points
plt.plot(x_spline, y_spline, label='Spline Curve')  # Plot spline curve
plt.xlabel('Time')
plt.ylabel('Flow Rate')
plt.title('Spline Interpolation')
plt.legend()
plt.grid(True)
plt.show()
'''



